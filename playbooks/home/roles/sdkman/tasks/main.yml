- name: Check if SDKMAN is installed
  stat:
    path: '{{ sdkman_init }}'
  register: sdkman_init_check

- name: Install SDKMAN
  when: not sdkman_init_check.stat.exists
  block:
    - name: Get installation script
      get_url:
        url: https://get.sdkman.io/
        dest: /tmp/get-sdkman.sh
        checksum: sha256:18c2813712380304beb282427fa976f27da7c4a72bee524fbc05a02bd9677a15

    - name: Install SDKMAN
      command: bash /tmp/get-sdkman.sh

- name: Update SDKMAN
  when: sdkman_init_check.stat.exists is defined and sdkman_init_check.stat.exists
  shell: source {{ sdkman_init }}  && sdk selfupdate
  args:
    executable: /bin/bash

- name: Install SDKMAN packages
  shell: source {{ sdkman_init }}  && sdk install {{ item }}
  args:
    executable: /bin/bash
  with_items: '{{ sdkman_packages }}'
